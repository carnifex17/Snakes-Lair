# FTP

## About

<mark style="color:red;">**File Transfer Protocol**</mark> is a standard communication <mark style="color:purple;">**protocol**</mark> used for the transfer of computer files from a server to a client on a computer network. **FTP** is built on a **clientâ€“server** model, and by default is using <mark style="color:yellow;">**port 21**</mark>

## Usage

#### Connect

```bash
ftp 13.13.13.13
```

#### Commands

```bash
get or mput - download a file or files
put or mput - upload a file or files
status - more info about server
ls cd - moving in directories
```

## TFTP

<mark style="color:red;">**vsFTPd**</mark> is one of the most used FTP servers on Linux-based distributions. The default configuration of vsFTPd can be found in <mark style="color:yellow;">**/etc/vsftpd.conf**</mark>. Users, for which access to FTP server is forbidden could be found at <mark style="color:green;">**`/etc/ftpusers`**</mark> file

## Dangerous Config Settings

* <mark style="color:green;">**`anonymous_enable=YES`**</mark> - Allowing anonymous login?
* <mark style="color:green;">**`anon_upload_enable=YES`**</mark> - Allowing anonymous to upload files?
* <mark style="color:green;">**`anon_mkdir_write_enable=YES`**</mark> - Allowing anonymous to create new directories?
* <mark style="color:green;">**`no_anon_password=YES`**</mark> - Do not ask anonymous for password?
* <mark style="color:green;">**`anon_root=/home/username/ftp`**</mark> - Directory for anonymous.
* <mark style="color:green;">**`write_enable=YES`**</mark> - Allow the usage of FTP commands

## Bruteforcing

We could do a FTP server **bruteforcing** or **password** spraying with <mark style="color:green;">**Medusa**</mark>

```bash
medusa -u carni17 -P /usr/share/wordlists/rockyou.txt -h 13.13.13.13 -M ftp 
```

**Options:**&#x20;

* <mark style="color:green;">**`-u`**</mark> for username and <mark style="color:green;">**`-U`**</mark> for list&#x20;
* <mark style="color:green;">**`-p`**</mark> for password and <mark style="color:green;">**`-P`**</mark> for list
* <mark style="color:green;">**`-h`**</mark> for host
* <mark style="color:green;">**`-M`**</mark> for protocol

## FTP Bounce Attack

We are using a **ftp** <mark style="color:green;">**`PORT`**</mark> command to trick **ftp server** into running command and getting information from device other than **ftp server**. As example we could use this to **scan the network** through **ftp**. You could look here for more explanation[ **\[LINK\]**](https://www.geeksforgeeks.org/what-is-ftp-bounce-attack/)**.** For making ftp bounce attack nmap scan we could use <mark style="color:green;">**`-b`**</mark> option:

```bash
nmap -Pn -v -n -p80 -b carni17:amogus@13.13.13.13 69.69.69.69
Where 13.13.13.13 is ftp server
```

## Tips2Hack

1. Try to use anonymous login, config allows that, you could lurk for some juicy info. For this just use <mark style="color:yellow;">**anonymous**</mark> as login name, and left password empty.
2. If config allows, you could lurk even faster through directories with recursive listing <mark style="color:green;">**`ls -R`**</mark>
3. To download a file you need to use <mark style="color:green;">**`get`**</mark> command and to upload you need <mark style="color:green;">**`put`**</mark> and also you could use <mark style="color:green;">**`status`**</mark> to get more info about server and FTP state
4. To <mark style="color:yellow;">**download**</mark> <mark style="color:yellow;">**all**</mark> <mark style="color:yellow;">**files**</mark> you need to use

```bash
wget -m --no-passive ftp://anonymous:anonymous@13.13.13.13
```

5. Check all available nmap ftp scripts:

```bash
find / -type f -name ftp* 2>/dev/null | grep scripts
```

***
