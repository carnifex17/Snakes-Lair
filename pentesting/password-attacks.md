# Password Attacks

## File Hunting

```bash
for ext in $(echo ".xls .xls* .xltx .csv .od* .doc .doc* .pdf .pot .pot* .pp*");do echo -e "\nFile extension: " $ext; find / -name *$ext 2>/dev/null | grep -v "lib\|fonts\|share\|core" ;done
```

***

## Hash Cracking

### Unshadow

* `.bak` file is a backup file

```bash
unshadow /tmp/passwd.bak /tmp/shadow.bak > /tmp/unshadowed.hashes
```

***

## Archive Cracking

### OpenSSL Encrypted

```bash
for i in $(cat rockyou.txt);do openssl enc -aes-256-cbc -d -in amogus.gzip -k $i 2>/dev/null| tar xz;done
```

### BitLocker Encrypted

```bash
bitlocker2john -i backup.vhd > backup.hashes #changing file to crackable type
grep "bitlocker\$0" backup.hashes > backup.hash #Filtering
hashcat -m 22100 backup.hash /opt/useful/seclists/rockyou.txt -o backup.crack #hashcat cracking
```

***

## Password Mutations

Password Mutations is technique, when you change some default passwords, or find out some personal information about target, and want to use it for password. But regularly even if person have dog named: <mark style="color:red;">**Richard**</mark>, password wouldn't be just <mark style="color:red;">**richard**</mark>, it would be <mark style="color:red;">**r1ch@rd15**</mark> as example. That's what the point of Password Mutation, change password to look for it's variations, or mutations.&#x20;

### Hachcat Rules

| Function | Description                                  |
| -------- | -------------------------------------------- |
| :        | Do nothing                                   |
| l        | lowercase all letters                        |
| u        | uppercase all letters                        |
| c        | capitalize first letter and lowercase others |
| sXY      | Replace all instances of X with Y            |
| $!       | Add exclamation character at the end         |

```bash
hashcat --force password.list -r mutation.rule --stdout | sort -u > mutated.list
```

Also you could use [<mark style="color:blue;">**CeWL**</mark>](https://www.geeksforgeeks.org/cewl-tool-creating-custom-wordlists-tool-in-kali-linux/) for making custom wordlists from someone's website.&#x20;

***

## John The Ripper

[**`John the Ripper`**](../tools/john-the-ripper.md)**`(JTR or john)`** is an essential pentesting tool used to check the strength of passwords and crack encrypted (or hashed) passwords using either **brute force** or **dictionary attacks**. It is open-source software initially developed for **UNIX-based** systems and first released in **1996.** Also it has a lot of sub-tools for translation files into crackable state\
For all **2john** tools you could use:&#x20;

```bash
locate *2john
```

After converting we could crack it with basic command:

<pre class="language-bash"><code class="lang-bash">ssh2john.py id_rsa > ssh.hash #changing file to crackable type
<strong>john --wordlist=rockyou.txt ssh.hash #cracking
</strong>john ssh.hash --show #show password if cracked succesfully
</code></pre>
